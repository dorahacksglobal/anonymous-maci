const { poseidon } = require('circom')
const { utils } = require('ethers')
const Tree = require('./tree')
const SNARK_FIELD_SIZE = 21888242871839275222246405745257275088548364400416034343698204186575808495617n

console.log(poseidon([111n, 111n]))

const tree = new Tree(5, 5, 0n)
tree.updateLeaf(0, 17401209058188062835777301922967402457286075379363344038559897609286240168482n)
tree.updateLeaf(1, 11187034626823300574854756318571030956284214761091118036780047574112191471325n)
tree.updateLeaf(2, 6546679624803441676558818450998666343841221492931590415630301625428782431882n)
tree.updateLeaf(3, 111n)

// console.log(poseidon([5072515977909863901921362755379204195596734597725765036260914137381154093180n, 21208579069277487353096895134850779332109091908481716530206315474074577099530n]))

// 17401209058188062835777301922967402457286075379363344038559897609286240168482n
// 11187034626823300574854756318571030956284214761091118036780047574112191471325n
// 6546679624803441676558818450998666343841221492931590415630301625428782431882n

// inputs[0] = _stateRoot();
// inputs[1] = coordinator.x;
// inputs[2] = coordinator.y;
// inputs[3] = voiceCreditBalance;
// inputs[4] = _maxVoteOptions;

console.log(tree.root, poseidon([
  tree.root,
  7421895562686352826563669933550830041677218724210020561066263498415701325176n,
  15885728170420100812951141355295788125825926252169931895803773048587171524289n,
  1000n,
  2n
]))

const inputHash = BigInt(utils.soliditySha256(
  new Array(7).fill('uint256'),
  [
    "13762082651509621980417321915556019904593369380137002005920482206921778191254",
    ...["11883316065092878549462203456190225165212168328553682889785780378550202904633", "7137494332171084542149167621901459661533440082738728472460578380429763235595", "1097397976533047587427708806903780141246718029375246728614298239105240378433", "6902216520380197931688454970029374636693777387246319085545612606298857233679", "4475837609357726148888858641226387679030713109526643384098143830075401240169", "1551161293803230069615224362169252190625838304050794875920776156406163829798"]
  ]
)) % SNARK_FIELD_SIZE

console.log(inputHash)

["13595992854758261345035734270152814196782143007367724172403976212412702681196", "14260033114148668415360672656474953389280542468753819358933401869009549019899", "15059170653647788878170994660818867884492732714613397244707459475610173480906", "8002990687193859275721319388845241758634683145604957254064462878016048732209", "17739268964216091273091851962720191855522957430304457314442997075961685349283", "11396575857037865249646245399463566924824221402712705203083397692519813854623", "12481252944293154452790831793681362061015050801093364402476416727084919361729", "4983316284037024604272472576311083669191667496621040019485883902651221785047"]
